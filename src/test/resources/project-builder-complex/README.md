# SampleComplexProject

This directory contains files generated by [Temple](https://templeeight.github.io/temple-docs)  

## Project Structure
* `/api`: API contains the OpenAPI schema for the project
* `/auth`: Backend code for the Auth service
* `/auth-db`: Initialisation scripts for the Auth database
* `/complex-user`: Backend code for the ComplexUser service
* `/complex-user-db`: Initialisation scripts for the ComplexUser database
* `/grafana`: Grafana configuration providing a dashboard for each service in the project
* `/kong`: Configuration for the Kong API Gateway
* `/kube`: YAML files for deploying the project with Kubernetes
* `/prometheus`: Prometheus configuration for each service in the project
* `deploy.sh`: Deployment script for local development (must be used with `source`)
* `push-image.sh`: Deployment script to push each script to a locally hosted registry

## API Documentation

### Auth

#### Register
**URL:** `/api/register`  
**Method:** `POST`  
**Description:** Register and get an access token  
**Request Contents:**  

|Parameter|Type|Details|
|---|---|---|
|email|String|Valid email address|
|password|String|Between 8 and 64 characters|


##### Success Response:
**Code:** `200 OK`  
**Response Body:**  
```
{
  "AccessToken" : ""
}
```


##### Error Responses:
**Code:** `400 BAD REQUEST`  
**Code:** `403 FORBIDDEN`  
**Code:** `500 INTERNAL SERVER ERROR`  


***

#### Login
**URL:** `/api/login`  
**Method:** `POST`  
**Description:** Login and get an access token  
**Request Contents:**  

|Parameter|Type|Details|
|---|---|---|
|email|String|Valid email address|
|password|String|Between 8 and 64 characters|


##### Success Response:
**Code:** `200 OK`  
**Response Body:**  
```
{
  "AccessToken" : ""
}
```


##### Error Responses:
**Code:** `400 BAD REQUEST`  
**Code:** `401 UNAUTHORIZED`  
**Code:** `500 INTERNAL SERVER ERROR`  


***

### ComplexUser Service

#### Create ComplexUser
**URL:** `/api/complex-user`  
**Method:** `POST`  
**Description:** Register a new complexuser  
**Auth:** Include Authorization header in format `Authorization: Bearer <token>`  
**Request Contents:**  

|Parameter|Type|Details|
|---|---|---|
|smallIntField|Integer|Min Value: 10, Max Value: 100, Precision: 2 bytes|
|intField|Integer|Min Value: 10, Max Value: 100, Precision: 4 bytes|
|bigIntField|Integer|Min Value: 10, Max Value: 100, Precision: 8 bytes|
|floatField|Float|Min Value: 0.0, Max Value: 300.0, Precision: 4 bytes|
|doubleField|Float|Min Value: 0.0, Max Value: 123.0, Precision: 8 bytes|
|stringField|String|Min Length: 1|
|boundedStringField|String|Min Length: 0, Max Length: 5|
|boolField|Boolean||
|dateField|Date|Format: 'YYYY-MM-DD'|
|timeField|Time|Format: 'HH:MM:SS.NNNNNN'|
|dateTimeField|DateTime|Format: 'YYYY-MM-DDTHH:MM:SS.NNNNNN'|
|blobField|Base64 String||


##### Success Response:
**Code:** `200 OK`  
**Response Body:**  
```
{
  "floatField" : 42.0,
  "timeField" : "23:59:59",
  "blobField" : "data",
  "bigIntField" : 42,
  "dateTimeField" : "2020-01-01T23:59:59",
  "id" : "00000000-0000-0000-0000-000000000000",
  "boundedStringField" : "string-contents",
  "intField" : 42,
  "doubleField" : 42.0,
  "stringField" : "string-contents",
  "boolField" : true,
  "smallIntField" : 42,
  "dateField" : "2020-01-01"
}
```


##### Error Responses:
**Code:** `400 BAD REQUEST`  
**Code:** `401 UNAUTHORIZED`  
**Code:** `500 INTERNAL SERVER ERROR`  


***

#### Read ComplexUser
**URL:** `/api/complex-user/{id}`  
**Method:** `GET`  
**Description:** Look up a single complexuser  
**Auth:** Include Authorization header in format `Authorization: Bearer <token>`  

##### Success Response:
**Code:** `200 OK`  
**Response Body:**  
```
{
  "floatField" : 42.0,
  "timeField" : "23:59:59",
  "blobField" : "data",
  "bigIntField" : 42,
  "dateTimeField" : "2020-01-01T23:59:59",
  "id" : "00000000-0000-0000-0000-000000000000",
  "boundedStringField" : "string-contents",
  "intField" : 42,
  "doubleField" : 42.0,
  "stringField" : "string-contents",
  "boolField" : true,
  "smallIntField" : 42,
  "dateField" : "2020-01-01"
}
```


##### Error Responses:
**Code:** `400 BAD REQUEST`  
**Code:** `401 UNAUTHORIZED`  
**Code:** `404 NOT FOUND`  
**Code:** `500 INTERNAL SERVER ERROR`  


***

#### Update ComplexUser
**URL:** `/api/complex-user/{id}`  
**Method:** `PUT`  
**Description:** Update a single complexuser  
**Auth:** Include Authorization header in format `Authorization: Bearer <token>`  
**Request Contents:**  

|Parameter|Type|Details|
|---|---|---|
|smallIntField|Integer|Min Value: 10, Max Value: 100, Precision: 2 bytes|
|intField|Integer|Min Value: 10, Max Value: 100, Precision: 4 bytes|
|bigIntField|Integer|Min Value: 10, Max Value: 100, Precision: 8 bytes|
|floatField|Float|Min Value: 0.0, Max Value: 300.0, Precision: 4 bytes|
|doubleField|Float|Min Value: 0.0, Max Value: 123.0, Precision: 8 bytes|
|stringField|String|Min Length: 1|
|boundedStringField|String|Min Length: 0, Max Length: 5|
|boolField|Boolean||
|dateField|Date|Format: 'YYYY-MM-DD'|
|timeField|Time|Format: 'HH:MM:SS.NNNNNN'|
|dateTimeField|DateTime|Format: 'YYYY-MM-DDTHH:MM:SS.NNNNNN'|
|blobField|Base64 String||


##### Success Response:
**Code:** `200 OK`  
**Response Body:**  
```
{
  "floatField" : 42.0,
  "timeField" : "23:59:59",
  "blobField" : "data",
  "bigIntField" : 42,
  "dateTimeField" : "2020-01-01T23:59:59",
  "id" : "00000000-0000-0000-0000-000000000000",
  "boundedStringField" : "string-contents",
  "intField" : 42,
  "doubleField" : 42.0,
  "stringField" : "string-contents",
  "boolField" : true,
  "smallIntField" : 42,
  "dateField" : "2020-01-01"
}
```


##### Error Responses:
**Code:** `400 BAD REQUEST`  
**Code:** `401 UNAUTHORIZED`  
**Code:** `404 NOT FOUND`  
**Code:** `500 INTERNAL SERVER ERROR`  


***

#### Delete ComplexUser
**URL:** `/api/complex-user/{id}`  
**Method:** `DELETE`  
**Description:** Delete a single complexuser  
**Auth:** Include Authorization header in format `Authorization: Bearer <token>`  

##### Success Response:
**Code:** `200 OK`  
**Response Body:**  
```
{}
```


##### Error Responses:
**Code:** `400 BAD REQUEST`  
**Code:** `401 UNAUTHORIZED`  
**Code:** `404 NOT FOUND`  
**Code:** `500 INTERNAL SERVER ERROR`  


***

#### Identify ComplexUser
**URL:** `/api/complex-user`  
**Method:** `GET`  
**Description:** Look up the single complexuser associated with the access token  
**Auth:** Include Authorization header in format `Authorization: Bearer <token>`  

##### Success Response:
**Code:** `302 FOUND`  
**Headers:**`Location: http://path/to/resource`  

##### Error Responses:
**Code:** `401 UNAUTHORIZED`  
**Code:** `404 NOT FOUND`  
**Code:** `500 INTERNAL SERVER ERROR`  


***

#### Create TempleUser
**URL:** `/api/complex-user/{parent_id}/temple-user`  
**Method:** `POST`  
**Description:** Register a new templeuser belonging to the provided complexuser  
**Auth:** Include Authorization header in format `Authorization: Bearer <token>`  
**Request Contents:**  

|Parameter|Type|Details|
|---|---|---|
|intField|Integer|Precision: 4 bytes|
|doubleField|Float|Precision: 8 bytes|
|stringField|String||
|boolField|Boolean||
|dateField|Date|Format: 'YYYY-MM-DD'|
|timeField|Time|Format: 'HH:MM:SS.NNNNNN'|
|dateTimeField|DateTime|Format: 'YYYY-MM-DDTHH:MM:SS.NNNNNN'|
|blobField|Base64 String||


##### Success Response:
**Code:** `200 OK`  
**Response Body:**  
```
{
  "timeField" : "23:59:59",
  "blobField" : "data",
  "dateTimeField" : "2020-01-01T23:59:59",
  "id" : "00000000-0000-0000-0000-000000000000",
  "dateField" : "2020-01-01",
  "intField" : 42,
  "doubleField" : 42.0,
  "stringField" : "string-contents",
  "boolField" : true
}
```


##### Error Responses:
**Code:** `400 BAD REQUEST`  
**Code:** `401 UNAUTHORIZED`  
**Code:** `500 INTERNAL SERVER ERROR`  


***

#### Read TempleUser
**URL:** `/api/complex-user/{parent_id}/temple-user/{id}`  
**Method:** `GET`  
**Description:** Look up a single templeuser belonging to the provided complexuser  
**Auth:** Include Authorization header in format `Authorization: Bearer <token>`  

##### Success Response:
**Code:** `200 OK`  
**Response Body:**  
```
{
  "timeField" : "23:59:59",
  "blobField" : "data",
  "dateTimeField" : "2020-01-01T23:59:59",
  "id" : "00000000-0000-0000-0000-000000000000",
  "dateField" : "2020-01-01",
  "intField" : 42,
  "doubleField" : 42.0,
  "stringField" : "string-contents",
  "boolField" : true
}
```


##### Error Responses:
**Code:** `400 BAD REQUEST`  
**Code:** `401 UNAUTHORIZED`  
**Code:** `404 NOT FOUND`  
**Code:** `500 INTERNAL SERVER ERROR`  


***

#### Update TempleUser
**URL:** `/api/complex-user/{parent_id}/temple-user/{id}`  
**Method:** `PUT`  
**Description:** Update a single templeuser belonging to the provided complexuser  
**Auth:** Include Authorization header in format `Authorization: Bearer <token>`  
**Request Contents:**  

|Parameter|Type|Details|
|---|---|---|
|intField|Integer|Precision: 4 bytes|
|doubleField|Float|Precision: 8 bytes|
|stringField|String||
|boolField|Boolean||
|dateField|Date|Format: 'YYYY-MM-DD'|
|timeField|Time|Format: 'HH:MM:SS.NNNNNN'|
|dateTimeField|DateTime|Format: 'YYYY-MM-DDTHH:MM:SS.NNNNNN'|
|blobField|Base64 String||


##### Success Response:
**Code:** `200 OK`  
**Response Body:**  
```
{
  "timeField" : "23:59:59",
  "blobField" : "data",
  "dateTimeField" : "2020-01-01T23:59:59",
  "id" : "00000000-0000-0000-0000-000000000000",
  "dateField" : "2020-01-01",
  "intField" : 42,
  "doubleField" : 42.0,
  "stringField" : "string-contents",
  "boolField" : true
}
```


##### Error Responses:
**Code:** `400 BAD REQUEST`  
**Code:** `401 UNAUTHORIZED`  
**Code:** `404 NOT FOUND`  
**Code:** `500 INTERNAL SERVER ERROR`  


***

#### Delete TempleUser
**URL:** `/api/complex-user/{parent_id}/temple-user/{id}`  
**Method:** `DELETE`  
**Description:** Delete a single templeuser belonging to the provided complexuser  
**Auth:** Include Authorization header in format `Authorization: Bearer <token>`  

##### Success Response:
**Code:** `200 OK`  
**Response Body:**  
```
{}
```


##### Error Responses:
**Code:** `400 BAD REQUEST`  
**Code:** `401 UNAUTHORIZED`  
**Code:** `404 NOT FOUND`  
**Code:** `500 INTERNAL SERVER ERROR`  


***
